<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Past Donations</title>
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
</head>
<body>
    <div class="container">
        <nav>
          <ul>
            <li><a href="#" class="logo">
              <img src="/logo.jpg" alt="Logo" />
              <span class="nav-item">NGO Dashboard</span>
            </a></li>
            <li><a href="view_donations.html">
              <i class="fas fa-box-open"></i>
              <span class="nav-item">View Donations</span>
            </a></li>
            <li><a href="claim_donations.html">
              <i class="fas fa-hand-holding"></i>
              <span class="nav-item">Claim Donations</span>
            </a></li>
            <li><a href="past_donations.html">
              <i class="fas fa-history"></i>
              <span class="nav-item">Past Donations</span>
            </a></li>
            <li><a href="/kc-frontend/logout.html" class="logout">
              <i class="fas fa-sign-out-alt"></i>
              <span class="nav-item">Log out</span>
            </a></li>
          </ul>
        </nav>
    

        <section class="main">
            <div class="main-top">
                <h1>Past Donations</h1>
                <i class="fas fa-history"></i>
            </div>

            <div class="dashboard-content">
                <h2>Past Donations Received</h2>
                <p>Here is the list of donations your NGO has received in the past:</p>
                
                <!-- Past Donations Table -->
                <table class="donation-table" id="pastDonationsTable">
                    <thead>
                        <tr>
                            <th>Donation ID</th>
                            <th>Food Type</th>
                            <th>Quantity</th>
                            <th>Expiry Date</th>
                            <th>PickUp Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be populated dynamically with JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <script>
        // Fetch past donations from the backend
        async function fetchPastDonations() {
            try {
                const response = await fetch('/ngo-dashboard/past_donations'); // Ensure this route is available in your backend
                if (!response.ok) {
                    throw new Error('Network response was not ok: ' + response.statusText);
                }

                const pastDonations = await response.json();
                const tableBody = document.getElementById('pastDonationsTable').getElementsByTagName('tbody')[0];
                tableBody.innerHTML = ''; // Clear the table before adding new data

                pastDonations.forEach(donation => {
                    const row = tableBody.insertRow();
                    row.insertCell(0).innerText = donation.DonationID;
                    row.insertCell(1).innerText = donation.FoodType;
                    row.insertCell(2).innerText = donation.Quantity;
                    row.insertCell(3).innerText = donation.ExpiryDate;
                    row.insertCell(4).innerText = donation.PickUpTime;
                    row.insertCell(5).innerText = donation.Status;
                });
            } catch (error) {
                console.error('Error fetching past donations:', error);
            }
        }

        // Call the function to fetch and display the donations when the page loads
        window.onload = fetchPastDonations;
    </script>
</body>
</html>
